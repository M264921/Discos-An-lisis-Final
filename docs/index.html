<!doctype html><html lang="es"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>MingoMedia (Multimedia Mingorance)</title>
<style>
*{box-sizing:border-box}
body{margin:0;padding:24px;font-family:"Inter","Segoe UI",Roboto,Ubuntu,Helvetica,Arial,sans-serif;background:#f4f6fb;color:#0f172a;line-height:1.5}
main{max-width:1280px;margin:0 auto}
h1{margin:0 0 12px;font-size:28px;font-weight:700;color:#0b1733}
#err{display:none;padding:12px 16px;border-radius:10px;background:#fee2e2;border:1px solid #fecaca;color:#7f1d1d;margin-bottom:16px}
.toolbar{display:flex;flex-wrap:wrap;gap:12px;align-items:center;margin-bottom:14px;position:relative}
.toolbar .summary{display:flex;align-items:center;gap:6px;font-weight:600;color:#1f2937}
.toolbar .summary .sep{color:#94a3b8}
.toolbar .search{flex:1;min-width:220px}
.toolbar input[type="search"]{width:100%;padding:9px 12px;border:1px solid #cbd5f5;border-radius:10px;background:#fff;color:#0f172a;transition:border .15s ease,box-shadow .15s ease}
.toolbar input[type="search"]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px rgba(37,99,235,.15)}
.toolbar select{padding:8px 10px;border:1px solid #cbd5f5;border-radius:10px;background:#fff;color:#0f172a}
.toolbar button{padding:8px 14px;border:none;border-radius:10px;background:#2563eb;color:#fff;font-weight:600;cursor:pointer;transition:background .15s ease,transform .15s ease}
.toolbar button:hover{background:#1d4ed8;transform:translateY(-1px)}
.toolbar button:disabled{background:#94a3b8;cursor:not-allowed;transform:none}
.btn-secondary{background:#fff;color:#1f2937;border:1px solid #cbd5f5}
.btn-secondary:hover{color:#2563eb;border-color:#2563eb}
.chips{display:flex;flex-wrap:wrap;gap:8px;margin:6px 0 18px}
.chips button{padding:6px 12px;border-radius:999px;border:1px solid #cbd5f5;background:#fff;color:#1f2937;font-size:13px;cursor:pointer;transition:all .15s ease}
.chips button[data-active="true"]{background:#1d4ed8;border-color:#1d4ed8;color:#fff;box-shadow:0 8px 18px -10px rgba(29,78,216,.85)}
.chips button:hover{border-color:#1d4ed8;color:#1d4ed8}
.chips .chip-all{font-weight:600}
.insights{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin:12px 0 22px}
.insights .card{background:#fff;border:1px solid #d7dff5;border-radius:14px;padding:16px;box-shadow:0 20px 46px -40px rgba(15,23,42,.45)}
.insights .card h2{margin:0 0 10px;font-size:15px;font-weight:700;color:#0b1733}
.insights .card ul{margin:0;padding-left:18px;color:#475569;font-size:13px}
.insights .card li{margin-bottom:6px}
.table-shell{background:#fff;border:1px solid #d7dff5;border-radius:16px;box-shadow:0 26px 54px -40px rgba(15,23,42,.45);overflow:auto;position:relative}
.table-shell.drag-active::after{content:"";position:absolute;inset:0;border:2px dashed rgba(37,99,235,.35);pointer-events:none}
table{width:100%;border-collapse:separate;border-spacing:0;min-width:840px}
thead tr:first-child th{position:sticky;top:0;background:#ecf1ff;color:#0f172a;font-size:13px;font-weight:600;z-index:2}
thead tr.filters th{position:sticky;top:46px;background:rgba(236,241,255,0.96);backdrop-filter:blur(3px);z-index:1}
.selector-header,.row-selector-cell{width:48px;min-width:48px;text-align:center;padding:0 8px}
.selector-header{position:sticky;left:0;background:#ecf1ff;border-right:1px solid #dbe4ff;z-index:3}
.row-selector-cell{position:sticky;left:0;background:#fff;border-right:1px solid #e2e8f0}
tbody tr:nth-child(even) .row-selector-cell{background:#f8faff}
tbody tr:hover .row-selector-cell{background:#e8f1ff}
.row-selector-cell input[type="checkbox"],.selector-header input[type="checkbox"]{width:16px;height:16px;cursor:pointer}
th,td{padding:10px 12px;border-bottom:1px solid #e2e8f0;text-align:left;font-size:13px;vertical-align:top}
tbody tr:nth-child(even){background:#f8faff}
tbody tr:hover{background:#e8f1ff}
.row-selected{box-shadow:inset 0 0 0 2px #2563eb;background:#e0ecff}
.row-selected .row-selector-cell{background:#d6e4ff}
.muted{color:#475569;font-size:12px}
.wrap{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}
.col-size{text-align:right;font-variant-numeric:tabular-nums}
.col-date{white-space:nowrap}
.th-content{display:flex;align-items:center;gap:6px}
.th-label{flex:1}
.resize-handle{position:absolute;right:0;top:0;width:6px;height:100%;cursor:col-resize}
.resize-handle::after{content:"";display:block;width:2px;height:60%;margin:auto;background:#9ca3af;border-radius:2px;opacity:0;transition:opacity .15s ease}
th:hover .resize-handle::after{opacity:.65}
th{position:relative;border-right:1px solid #dbe4ff}
th:last-child{border-right:none}
th.drag-source{opacity:.6}
th.drop-target{box-shadow:inset 0 0 0 2px #2563eb}
thead input{width:100%;padding:7px 8px;border:1px solid #cbd5f5;border-radius:8px;font-size:12px;background:#fff;color:#0f172a}
.cell-link{color:#2563eb;text-decoration:none;word-break:break-word}
.cell-link:hover{text-decoration:underline}
.pagination{display:flex;justify-content:space-between;align-items:center;margin:16px 0 8px}
.pagination .controls{display:flex;gap:8px}
.pagination button{padding:7px 12px;border-radius:10px;border:1px solid #cbd5f5;background:#fff;color:#0f172a;font-weight:500;cursor:pointer}
.pagination button:hover:not(:disabled){border-color:#2563eb;color:#2563eb}
.pagination button:disabled{opacity:.45;cursor:not-allowed}
.pagination .info{font-size:13px;color:#475569}
.selection-indicator{font-size:13px;color:#1f2937;display:flex;align-items:center;gap:8px}
.selection-indicator[hidden]{display:none}
.selection-indicator strong{font-weight:600;color:#2563eb}
.selection-actions{display:flex;align-items:center;gap:6px}
.link-button{border:none;background:none;padding:0;color:#2563eb;font-size:13px;font-weight:600;cursor:pointer;text-decoration:underline}
.link-button:disabled{color:#94a3b8;cursor:not-allowed;text-decoration:none}
.access-gate{position:fixed;inset:0;background:rgba(15,23,42,.75);display:flex;align-items:center;justify-content:center;padding:24px;backdrop-filter:blur(4px);z-index:9999}
.access-gate[hidden]{display:none}
.access-card{max-width:360px;width:100%;background:#fff;border-radius:18px;padding:24px;box-shadow:0 40px 90px -45px rgba(15,23,42,.6);display:flex;flex-direction:column;gap:18px}
.access-card h2{margin:0;font-size:20px;font-weight:700;color:#0b1733}
.access-card p{margin:0;font-size:13px;color:#475569}
.access-form{display:flex;flex-direction:column;gap:12px}
.access-form label{display:flex;flex-direction:column;gap:6px;font-size:13px;color:#1f2937}
.access-form input{padding:9px 12px;border:1px solid #cbd5f5;border-radius:10px;background:#f8fafc;color:#0f172a;font-size:14px}
.access-form input:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px rgba(37,99,235,.18)}
.access-error{color:#b91c1c;background:#fee2e2;border:1px solid #fecaca;padding:10px 12px;border-radius:10px;font-size:13px}
.access-error[hidden]{display:none}
.access-form button{padding:10px 14px;border:none;border-radius:10px;background:#2563eb;color:#fff;font-weight:600;font-size:14px;cursor:pointer;transition:background .15s ease,transform .15s ease}
.access-form button:hover{background:#1d4ed8;transform:translateY(-1px)}
.access-form button:disabled{background:#94a3b8;cursor:not-allowed;transform:none}
.view-panel{position:absolute;top:110%;right:0;width:320px;max-width:90vw;background:#fff;border:1px solid #d7dff5;border-radius:16px;box-shadow:0 30px 80px -45px rgba(15,23,42,.55);padding:18px;display:flex;flex-direction:column;gap:16px;z-index:20}
.view-panel[hidden]{display:none}
.view-panel-header{display:flex;justify-content:space-between;align-items:center;gap:12px}
.view-panel-header h3{margin:0;font-size:15px;font-weight:700;color:#0b1733}
.view-panel-close{border:none;background:none;font-size:18px;line-height:1;color:#475569;cursor:pointer;padding:4px}
.view-panel-section{display:flex;flex-direction:column;gap:10px}
.view-panel-section h4{margin:0;font-size:13px;font-weight:600;color:#1f2937}
.view-panel-columns{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:8px;max-height:200px;overflow:auto}
.view-panel-columns li{display:flex;align-items:center;justify-content:space-between;gap:8px;font-size:13px;color:#1f2937}
.view-panel-columns label{display:flex;align-items:center;gap:8px;cursor:pointer}
.view-panel-columns input[type="checkbox"]{width:16px;height:16px}
.view-panel-hidden-rows{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:8px;max-height:160px;overflow:auto}
.view-panel-hidden-rows li{display:flex;align-items:center;justify-content:space-between;gap:8px;font-size:12px;color:#475569}
.view-panel-hidden-rows li .hidden-row-label{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.view-panel-footer{display:flex;justify-content:flex-end}
.hidden-rows-banner{margin:12px 0;padding:10px 14px;border-radius:12px;background:#f1f5ff;color:#1f2937;border:1px solid #cbd5f5;display:flex;align-items:center;gap:12px;font-size:13px}
.hidden-rows-banner[hidden]{display:none}
.selection-rect{position:absolute;border:2px solid rgba(37,99,235,.6);background:rgba(37,99,235,.12);pointer-events:none;border-radius:8px;z-index:15}
.row-selector-cell{position:sticky;left:0;background:#fff;border-right:1px solid #e2e8f0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px;padding:4px 6px}
.row-selector-cell .row-selector-wrap{display:flex;align-items:center;justify-content:center;gap:6px}
.row-selector-cell .row-selector-wrap button{border:none;background:none;padding:2px;color:#94a3b8;cursor:pointer;line-height:1}
.row-selector-cell .row-selector-wrap button:hover{color:#2563eb}
.row-resize-handle{display:block;width:100%;height:6px;cursor:ns-resize;margin-top:auto}
.row-resize-handle::after{content:"";display:block;width:40%;height:2px;margin:2px auto 0;background:#9ca3af;border-radius:2px;opacity:.65}
.row-drag-select{box-shadow:inset 0 0 0 2px rgba(37,99,235,.55);background:#e0ecff}
</style><link rel="stylesheet" href="./assets/css/picker.css"/></head><body>
<header class="site-header">
  <div class="brand">MingoMedia</div>
  <div class="player-picker">
    <label for="globalPlayerSelect">Reproductor:</label>
    <select id="globalPlayerSelect">
      <option value="auto" selected>Auto (seg√∫n archivo)</option>
      <option value="choose">Elegir cada vez‚Ä¶</option>
      <option value="local">Este navegador</option>
      <option value="browser-picker">Chromecast / AirPlay‚Ä¶</option>
      <!-- DLNA din√°micos aqu√≠ -->
    </select>
    <button id="airplayBtn" hidden>AirPlay</button>
  </div>
</header>

<!-- Modal ‚ÄúAbrir con‚Ä¶‚Äù -->
<div id="openWithModal" class="ow-modal" hidden aria-hidden="true" role="dialog" aria-modal="true">
  <div class="ow-backdrop" data-ow-close></div>
  <div class="ow-dialog" role="document">
    <button class="ow-x" type="button" aria-label="Cerrar" data-ow-close>‚úï</button>
    <h3 class="ow-title" id="owDialogTitle">Abrir con‚Ä¶</h3>
    <p id="owFileName" class="ow-filename"></p>
    <div class="ow-actions">
      <button data-action="open-local">Este navegador</button>
      <button data-action="browser-picker">Chromecast / AirPlay‚Ä¶</button>
      <button data-action="dlna" hidden>DLNA de la red</button>
      <button data-action="new-tab">Nueva pesta√±a</button>
      <button data-action="download">Descargar</button>
    </div>
  </div>
</div>
<main>
<h1>MingoMedia ¬∑ Multimedia Mingorance</h1>
<div id="err"></div>
<div class="toolbar">
  <div class="summary"><span id="count">0</span> archivos <span class="sep">&middot;</span> <span id="size">0</span> visibles</div>
  <div class="selection-indicator" id="selectionIndicator" hidden>
    <div class="selection-actions">
      <strong id="selectionCount">0</strong> seleccionados
      <button type="button" class="link-button" id="hideSelectedBtn">Ocultar</button>
    </div>
  </div>
  <div class="search"><input id="q" type="search" placeholder="Buscar por ruta, nombre o hash"/></div>
  <select id="pageSize">
    <option value="25">25 por p√°gina</option>
    <option value="50" selected>50 por p√°gina</option>
    <option value="100">100 por p√°gina</option>
    <option value="250">250 por p√°gina</option>
    <option value="0">Todos</option>
  </select>
  <button class="btn-secondary" id="resetColumns">Reset columnas</button>
  <button class="btn-secondary" id="viewManagerBtn" aria-haspopup="true" aria-expanded="false">Vista‚Ä¶</button>
  <button id="downloadBtn" disabled>Descargar CSV</button>
  <div class="view-panel" id="viewPanel" hidden>
    <div class="view-panel-header">
      <h3>Preferencias de vista</h3>
      <button type="button" class="view-panel-close" id="closeViewPanel" aria-label="Cerrar">‚úï</button>
    </div>
    <div class="view-panel-section">
      <h4>Columnas visibles</h4>
      <ul class="view-panel-columns" id="columnToggleList"></ul>
    </div>
    <div class="view-panel-section">
      <h4>Filas ocultas</h4>
      <p id="hiddenRowsMessage" class="muted">No hay filas ocultas.</p>
      <ul class="view-panel-hidden-rows" id="hiddenRowsList"></ul>
      <button type="button" class="btn-secondary" id="showHiddenRowsBtn" disabled>Mostrar todas</button>
    </div>
    <div class="view-panel-footer">
      <button type="button" id="resetViewBtn">Reset vista</button>
    </div>
  </div>
</div>
<div class="insights">
  <div class="card">
    <h2>Unidades visibles</h2>
    <ul id="unitSummary"></ul>
  </div>
  <div class="card">
    <h2>Extensiones principales</h2>
    <ul id="extSummary"></ul>
  </div>
  <div class="card">
    <h2>Carpetas destacadas</h2>
    <ul id="pathSummary"></ul>
  </div>
</div>
<div class="chips" id="unitChips"></div>
<div class="table-shell" id="tableShell">
  <table id="tbl">
    <thead>
      <tr id="headerRow"></tr>
      <tr class="filters" id="filterRow"></tr>
    </thead>
    <tbody></tbody>
  </table>
</div>
<div class="hidden-rows-banner" id="hiddenRowsBanner" hidden>
  <span><strong id="hiddenRowsCount">0</strong> filas ocultas en esta vista.</span>
  <button type="button" class="btn-secondary" id="hiddenRowsShowBtn">Mostrar todas</button>
</div>
<div class="pagination">
  <div class="info" id="pageInfo"></div>
  <div class="controls">
    <button id="prevPage">Anterior</button>
    <button id="nextPage">Siguiente</button>
  </div>
</div>

<script id="INV_B64" type="application/octet-stream" data-src="data/inventory.json">

</script>
</main>
<div id="accessGate" class="access-gate" hidden>
  <div class="access-card" role="dialog" aria-modal="true" aria-labelledby="accessTitle">
    <h2 id="accessTitle">Acceso privado</h2>
    <p id="accessMessage">Introduce tu correo para continuar.</p>
    <form id="accessForm" class="access-form" novalidate>
      <label for="accessEmail">Correo electr√≥nico
        <input id="accessEmail" name="email" type="email" autocomplete="email" required />
      </label>
      <label for="accessPin" id="accessPinLabel">PIN (opcional)
        <input id="accessPin" name="pin" type="password" inputmode="numeric" autocomplete="one-time-code" />
      </label>
      <p class="access-error" id="accessError" hidden></p>
      <button type="submit" id="accessSubmit">Entrar</button>
    </form>
  </div>
</div>
<script src="./assets/js/mingomedia-config.js"></script>
<script src="./assets/js/inventory-state.js"></script>
<script src="./assets/js/inventory-app.js"></script>
<script defer src="./assets/js/picker.js"></script></body></html>
<script type="module">
  import { loadInventory } from "./assets/inventory-loader.js";
  (async () => {
    try {
      const data = await loadInventory({ gzUrl: "data/inventory.json.gz", jsonUrl: "data/inventory.json" });
      // TODO: reemplaza initApp(data) por la funciÛn que ya tengas para iniciar la tabla/p·gina
      if (window.initApp) {
        window.initApp(data);
      } else if (window.renderInventory) {
        window.renderInventory(data);
      } else {
        console.log("Inventario cargado (size):", Array.isArray(data) ? data.length : Object.keys(data||{}).length);
      }
    } catch (err) {
      console.error("No se pudo cargar el inventario:", err);
      const banner = document.createElement("div");
      banner.style.cssText = "background:#fee;border:1px solid #f99;color:#900;padding:12px;margin:12px 0;border-radius:8px";
      banner.textContent = "[!] No se pudo cargar el inventario (gz y json). Revisa la consola para m·s detalles.";
      document.body.prepend(banner);
    }
  })();
</script>
